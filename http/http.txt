
web安全威胁浅析

1.web应用的三层架构
web浏览器-web页面-业务逻辑层-数据层-数据库服务器
出现问题通常在web层和业务逻辑层，主要是发起的参数和内容出现问题导致的漏洞


2.常见漏洞
	逻辑漏洞：越权操作、越权访问、暴力破解、短信轰炸、任意密码重置、信息遍历等
	编码层面漏洞：sql注入、xss、csrf、ssrf、任意文件上传、代码执行、命令执行漏洞


3.逻辑漏洞相关：
逻辑漏洞的核心思想：绕过其中真实的用户身份或者正常业务流程达到预期目的
漏洞分类：可以参考WASC的漏洞分类
	1.身份认证安全（登录、密码找回、会话）
	    验证机制-账号密码
		a.验证机制是web应用中最简单的一种安全机制，但是它处于安全防御的最前沿，如果被攻破了，通常应用程序的全部功能、数据都会被控制。
		b.缺乏安全有效的验证机制，其他核心安全机制都无法实施
		c.未加密的明文传输：很多工具如Burpsuite自身提供了一些常用的密码破解list，没有请求次数限制的情况很容易被暴力破解
		d.前端简单加密，没有通过自算法加密，例如用编码加密，后端解密校验，利用解密工具：如BP解密，在线cmd5等
		处理方式：添加验证码、请求次数检查、双因子认证、非常规的账号或密码（admin、root、test...）
	    会话授权：
		a.会话令牌生成漏洞：一些会话令牌通过用户的用户名或电子邮件地址转换而来，通过十六进制或者ASCII之类的加密
		eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1OTkxOTA4NzUsImlzcyI6Imx0IGRkaSB1c2VyIGxvZ2luIn0.hUXacolwC_Cf3j66G5tVK9dQOqzuIizBcXYEoTpliRU
		eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1OTkyMzA5NzQsImlzcyI6IldRYUtCUmtNZXV1Z1pBQnQzIn0.zFAqXCS3QkgP_EQWJ5cvMxra7-f4VinwO-NkjbJ5gA4
		b.会话传输过程漏洞：会话终止攻击：我们希望尽可能缩短一个会话的寿命，可降低攻击者截获或滥用有效会话令牌的可能性。
		其次，如果用户不再需要现有会话，终止会话为用户提供一种失效的途径，在某种程度上确保共享环境中的会话安全。
		会话劫持攻击：例如xss攻击获取被攻击者会话令牌
		处理方式：HTTPS传输、软硬会话过期、提供完善的注销功能
	    密码找回：
		a.手机号、邮箱篡改：修改手机号参数为其他手机号、邮箱号
		b.流程跳过：例如忘记密码功能-安全问题，安全邮箱，多阶段验证，
		  未在每个阶段明确确认用户身份，用户状态发生变化时没有校验
		
	2.业务一致性比对
		a.地址查看：修改地址ID，遍历最后2位或3位（一般ID为自增长）
		b.订单查看：修改订单ID，遍历最后2位或3位
		c.流程跳过

	3.业务数据篡改
		a.金额篡改：积分、价格。
		b.数量和限制修改：数量限制突破（参数修改、并发）、抽奖次数
		一般出现在校验都用前端控制，未在服务端进行校验

	4.用户输入的合规性
		xss:反射测试
		搜索注入、万能密码

	5.验证码突破：
		a.验证码直接在前端生成，并被服务端忽略处理
		b.验证码长期不失效，可以重复利用
		c.查看验证码是否回显

	6.业务未授权/被授权
		a.越权访问：垂直越权、水平越权
	
	7.时间绕过、扰乱测试
		a.更改时间参数
		b.时间过期：活动结束的业务尝试修改包中的时间为限定时间内的

	8.接口调用漏洞：
		a.数据泄露
		b.短袖炸弹
		c.重放攻击
		d.接口查询

	9.业务流程乱序执行















